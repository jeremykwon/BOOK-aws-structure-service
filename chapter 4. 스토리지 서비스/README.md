# AWS 스토리지 서비스


## S3
---
- S3 란 스토리지 서비스로 객체(텍스트, 음성, 이미지)와 같은 데이터를 저장한다.
- Key 만으로 데이터를 관리하며 디렉터리 구조가 아니다
- 특징
	- 무제한 용량 - 객체당 5TB, 객체수와 전체 용량에는 제한이 없다.
	- 높은 내구성 - 일반적으로 데이터가 3개의 AZ로 복사
	- 저렴한 비용 - 서울 리전의 표준 스토리지 요금이 1개월당 0.025USD/GB
- 프리티어가 다운로드의 경우 100GB 까지 제공된다.
	- 프리티어는 12개월간 제공
	- 5GB 이하의 데이터 저장은 무료
	- 매월 GET 20,000 회, PUT 2,000 회 이하 요청시 무료
	- EC2 등에서 S3로 데이터 업로드는 무료
 ![](https://i.imgur.com/SYLarAf.png)
S3 → 인터넷 다운로드 (Outbound) : 유저가 다운로드
S3 → EC2 다운로드 (같은 리전): EC2에서 S3에 있는 파일을 읽어 유저에게 제공

> <mark style="background: #DCFF8C;">**직접 접근하면 비용이 청구되므로, EC2를 통해 S3에 접속하는 것이 유리**</mark>


### S3 용어 및 기본 조작
- 버킷: 데이터를 저장하는 장소로 버킷의 이름은 전세계에서 고유해야한다
- 객체: 버킷에 저장된 데이터
- 키: 객체의 저장 URL 경로
- 등록 삭제가 가능한 API 를 제공한다.
- 유저의 실수로 데이터를 삭제하는 경우를 방지하기 위해, 버전 관리 기능 활성화시 모든 객체에 대한 이력 정보가 보존된다. (추가 요금 발생하며 일정 기간이 지나면 버전을 삭제하는 방식으로도 운영 가능)

### 스토리지 클래스
![](https://i.imgur.com/GvAo31G.png)

어느것을 사용해야 좋을지 모르겠다면 <mark style="background: #DCFF8C;">S3용 액세스 분석기</mark> 기능을 통해 얼마나 접근ㅇ ㅣ있었는지 등 데이터의 접근 상황을 참고하면 좋다.

> 내가 만드는 서비스들의 경우 기본적으로 standard 를 쓰는게 가장 좋아보인다.


### S3 데이터를 안전하게 공개
- 접근 제어
	- IAM 정책 - 유저 단위로 데이터 조작을 제어
	- 접근 제어 목록 (ACL) - 객체나 버킷 단위로 설정할 수 있는 접근 제어
	- 버킷 설정 - 버킷 단위로 설정하는 접근 제어로 '파일명이 xxx로 시작하는 데이터에 접근허용' 과 같이 복잡한 설정이 가능
- <mark style="background: #DCFF8C;">웹 사이트 호스팅 기능 활성화시 `http://버킷명.s3-website-리전이름.amazon.com` 과 같이 URL이 만들어지며 브라우저에서 해당 URL 로 접속이 가능하다.</mark>
- S3 는 암호화된 통신인 HTTPS 를 지원하지 않으므로 민감한 정보가 포함된 사이트를 운영해야하는 경우 콘텐츠 전송 네트워크(CDN) 서비스인 CloudFront를 함께 사용해 HTTPS통신을 할 수 있게 구성한다.
	- 현재 GPT 검색시 S3도 HTTPS를 지원한다.
	- 하지만 <mark style="background: #DCFF8C;">CF 사용의 장점</mark>이 있다.
		- **사용자 지정 도메인에 HTTPS 적용이 가능 (도메인 커스텀 가능)**
		- **비용 절감 - S3 직접 다운로드보다 캐싱되어 데이터 전송 비용 절감 가능**
		- **속도 향상 - CF는 전 세계 엣지 로케이션에서 데이터를 제공하여 S3 보다 더 빠른 응답 속도 제공** 
		- **보안 강화 - S3 를 퍼블릭하게 열지 않고 CF를 통해서만 접근 하도록 설정 가능**
	
> 상식: <mark style="background: #DCFF8C;">엣지 로케이션</mark>이란?
> CF 같은 CDN 서비스가 데이터를 캐싱하고, 사용자에게 빠르게 제공하는 전 세계 분산 서버를 의미
> 리전은 전세계에 30개 정도 존재, 엣지 로케이션은 450개 정도 존재해 사용자 가까운 곳에서 더 빠르게 응답이 가능하다.


## EBS (Amazon Elastic Block Store)
----
- EC2와 함께 사용하는 스토리지 서비스, EC2의 HDD/SSD 와 같은 역할
- 백업을 위한 스냅샷기능 지원 -> 스냅샷 생성 당시 EBS에 보존하고 있던 모든 정보가 백업
	- 스냅샷은 S3에 저장되며 저비용이면서 높은 내구성을 같는다.
	- 설정된 시간에 데이터를 백업할 수 있다.
- EC2는 정지한 경우 요금발생X, EBS는 용량 확보 순간부터 계속 요금이 발생된다.

> 재미있는 상식
> <mark style="background: #DCFF8C;">AWS Snow Family</mark> 를 최근 유튜브에서 봤는데 책에서도 소개해 정리해본다.
> 인터넷을 통한 파일 전송이 오래 걸리는 경우 데이터 전송을 빨리 하기위해 사용되는 서비스로
> 물리 스토리지를 빌려 AWS 스토리지로 직접 옮겨주는 서비스